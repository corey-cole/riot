<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<title>RIOT-Stream</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="./asciidoctor.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>RIOT-Stream</h1>
<div class="details">
<span id="revnumber">version 2.18.3</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">1. Introduction</a></li>
<li><a href="#_getting-started">2. Getting Started</a>
<ul class="sectlevel2">
<li><a href="#_install">2.1. Install</a></li>
<li><a href="#_usage">2.2. Usage</a></li>
</ul>
</li>
<li><a href="#_importing">3. Importing</a></li>
<li><a href="#_exporting">4. Exporting</a></li>
<li><a href="#_architecture">5. Architecture</a>
<ul class="sectlevel2">
<li><a href="#batch">5.1. Batching</a></li>
<li><a href="#threads">5.2. Multi-threading</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
RIOT-Stream has been deprecated in favor of the <a href="https://github.com/redis-field-engineering/redis-kafka-connect">Redis Kafka Connector</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction"><a class="anchor" href="#_introduction"></a>1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>RIOT-Stream is a command-line utility that lets you import and export data from Kafka topics.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_getting-started"><a class="anchor" href="#_getting-started"></a>2. Getting Started</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_install"><a class="anchor" href="#_install"></a>2.1. Install</h3>
<div class="paragraph">
<p>RIOT-Stream can be installed in different ways depending on your environment and preference.</p>
</div>
<div class="sect3">
<h4 id="_homebrew_macos"><a class="anchor" href="#_homebrew_macos"></a>2.1.1. Homebrew (macOS)</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="source">brew install redis-developer/tap/riot-stream</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_scoop_windows"><a class="anchor" href="#_scoop_windows"></a>2.1.2. Scoop (Windows)</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="source">scoop bucket add redis-developer https://github.com/redis-developer/scoop.git
scoop install riot-stream</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_download_and_run_linux"><a class="anchor" href="#_download_and_run_linux"></a>2.1.3. Download and run (Linux)</h4>
<div class="paragraph">
<p>RIOT-Stream requires Java and the easiest option is to use the version packaged with Ubuntu.
By default Ubuntu 18.04 includes Open JDK 11.</p>
</div>
<div class="paragraph">
<p>To install this version, first update the package index:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">sudo apt update</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next, check if Java is already installed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">java -version</code></pre>
</div>
</div>
<div class="paragraph">
<p>If Java is not currently installed, youâ€™ll see the following output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">Command 'java' not found, but can be installed with:

sudo apt install default-jre
sudo apt install openjdk-11-jre-headless
sudo apt install openjdk-8-jre-headless</code></pre>
</div>
</div>
<div class="paragraph">
<p>Execute the following command to install the default Java Runtime Environment (JRE), which will install the JRE from OpenJDK 11:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">sudo apt install default-jre</code></pre>
</div>
</div>
<div class="paragraph">
<p>Verify the installation with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">java -version</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should see output similar to the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">openjdk version &quot;11.0.11&quot; 2021-04-20
OpenJDK Runtime Environment (build 11.0.11+9-Ubuntu-0ubuntu2.18.04)
OpenJDK 64-Bit Server VM (build 11.0.11+9-Ubuntu-0ubuntu2.18.04, mixed mode, sharing))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Download the <a href="https://github.com/redis-developer/riot/releases/latest">latest release</a>, unzip, and copy to the desired location.</p>
</div>
<div class="paragraph">
<p>Now launch the <code>bin/riot-stream</code> script and follow the usage information provided.</p>
</div>
</div>
<div class="sect3">
<h4 id="_docker"><a class="anchor" href="#_docker"></a>2.1.4. Docker</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="source">docker run jruaux/riot-stream [OPTIONS] [COMMAND]</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_usage"><a class="anchor" href="#_usage"></a>2.2. Usage</h3>
<div class="paragraph">
<p>To display usage help, run the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="source"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
</pre></td>
  <td class="code"><pre><span class="green">riot-stream</span> --help</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Redis connection options are the same as <code>redis-cli</code>.</p>
</div>
<div class="paragraph">
<p>For Redis URI syntax see <a href="https://github.com/lettuce-io/lettuce-core/wiki/Redis-URI-and-connection-details#uri-syntax">here</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can use <code>--help</code> on any subcommand:</p>
</div>
<div class="listingblock">
<div class="content">
<pre><span class="green">riot-stream</span> <span class="red">command</span> --help
<span class="green">riot-stream</span> command <span class="red">subcommand</span> --help</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_importing"><a class="anchor" href="#_importing"></a>3. Importing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>import</code> command reads messages from a Kafka topic and writes them to a Redis stream.</p>
</div>
<div class="paragraph">
<p>The general usage is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre><span class="green">riot-stream</span> -h &lt;redis host&gt; -p &lt;redis port&gt; import --broker &lt;host:port&gt; <span class="olive">TOPIC</span>...</pre>
</div>
</div>
<div class="paragraph">
<p>To show the full usage, run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre><span class="green">riot-stream</span> import --help</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Import example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">riot-stream import topic1 --broker localhost:9092</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_exporting"><a class="anchor" href="#_exporting"></a>4. Exporting</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>export</code> command reads message from a Redis stream and writes them to a Kafka topic.
The general usage is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre><span class="green">riot-stream</span> -h &lt;redis host&gt; -p &lt;redis port&gt; export --broker &lt;host:port&gt; <span class="olive">STREAM</span>...</pre>
</div>
</div>
<div class="paragraph">
<p>To show the full usage, run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre><span class="green">riot-stream</span> export --help</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Export example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">riot-stream export stream1 --idle-timeout 500 --broker localhost:9092</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_architecture"><a class="anchor" href="#_architecture"></a>5. Architecture</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="architecture.svg" alt="architecture">
</div>
</div>
<div class="paragraph">
<p>RIOT-Stream processes data in batch fashion: a fixed number of records (batch AKA chunk) is read, processed, and written at a time.
Then the cycle is repeated until there&#8217;s no more data on the source.</p>
</div>
<div class="sect2">
<h3 id="batch"><a class="anchor" href="#batch"></a>5.1. Batching</h3>
<div class="paragraph">
<p>The default batch size is 50, which means that an execution step reads 50 items at a time from the source, processes them, and finally writes then to the target.
If the target is Redis, writing is done in a single command <a href="https://redis.io/topics/pipelining">pipeline</a> to minimize the number of roundtrips to the server.</p>
</div>
<div class="paragraph">
<p>You can change the batch size (and hence pipeline size) using the <code>--batch</code> option.
The optimal batch size in terms of throughput depends on a few factors like record size and command types (see <a href="https://stackoverflow.com/a/32165090">here</a> for details).</p>
</div>
</div>
<div class="sect2">
<h3 id="threads"><a class="anchor" href="#threads"></a>5.2. Multi-threading</h3>
<div class="paragraph">
<p>It is possible to parallelize processing by using multiple threads.
In that configuration, each chunk of items is read, processed, and written in a separate thread of execution.</p>
</div>
<div class="paragraph">
<p>To set the number of threads use the <code>--threads</code> option.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 2.18.3<br>
Last updated 2022-09-23 03:25:10 UTC
</div>
</div>
<link rel="stylesheet" href="./coderay-asciidoctor.css">
</body>
</html>